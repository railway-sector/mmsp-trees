"use strict";(self.webpackChunkmmsp_trees=self.webpackChunkmmsp_trees||[]).push([[23875],{2052:(e,t,i)=>{i.d(t,{i:()=>l});class l{constructor(e,t,i,l){this._hasNoDataValues=null,this._minValue=null,this._maxValue=null,"pixelData"in e?(this.values=e.pixelData,this.width=e.width,this.height=e.height,this.noDataValue=e.noDataValue):(this.values=e,this.width=t,this.height=i,this.noDataValue=l)}get hasNoDataValues(){if(null==this._hasNoDataValues){const e=this.noDataValue;this._hasNoDataValues=this.values.includes(e)}return this._hasNoDataValues}get minValue(){return this._ensureBounds(),this._minValue}get maxValue(){return this._ensureBounds(),this._maxValue}get usedMemory(){return this.values.byteLength+256}_ensureBounds(){if(null!=this._minValue)return;const{noDataValue:e,values:t}=this;let i=1/0,l=-1/0,a=!0;for(const r of t)r===e?this._hasNoDataValues=!0:(i=r<i?r:i,l=r>l?r:l,a=!1);a?(this._minValue=0,this._maxValue=0):(this._minValue=i,this._maxValue=l>-3e38?l:0)}}},23875:(e,t,i)=>{i.r(t),i.d(t,{default:()=>S});var l=i(6326),a=i(3825),r=i(50076),s=i(30726),o=i(77717),n=i(50346),h=i(90534),p=i(46053),c=(i(81806),i(76460),i(47249),i(28379)),u=i(87990),d=i(91605),y=i(25515),v=i(76328),m=i(19502),g=i(11270),f=i(94729),w=i(95363),C=i(2052),b=i(60883);let D=class extends((0,v.f)((0,m.b)((0,g.q)((0,f.A)((0,o.P)(y.A)))))){constructor(){super(...arguments),this.capabilities={operations:{supportsTileMap:!1}},this.copyright=null,this.heightModelInfo=null,this.path=null,this.minScale=void 0,this.maxScale=void 0,this.opacity=1,this.operationalLayerType="ArcGISTiledElevationServiceLayer",this.sourceJSON=null,this.type="elevation",this.url=null,this.version=null,this._lercDecoder=(0,b.b)()}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}destroy(){this._lercDecoder=(0,s.Gz)(this._lercDecoder)}readCapabilities(e,t){const i=t.capabilities&&t.capabilities.split(",").map(e=>e.toLowerCase().trim());return i?{operations:{supportsTileMap:i.includes("tilemap")}}:{operations:{supportsTileMap:!1}}}readVersion(e,t){let i=t.currentVersion;return i||(i=9.3),i}load(e){const t=null!=e?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"],supportsData:!1,validateItem:e=>{if(e.typeKeywords)for(let t=0;t<e.typeKeywords.length;t++)if("elevation 3d layer"===e.typeKeywords[t].toLowerCase())return!0;throw new r.A("portal:invalid-layer-item-type","Invalid layer item type '${type}', expected '${expectedType}' ",{type:"Image Service",expectedType:"Image Service Elevation 3D Layer"})}},e).catch(n.QP).then(()=>this._fetchImageService(t))),Promise.resolve(this)}fetchTile(e,t,i,l){const r=l?.signal,s={responseType:"array-buffer",signal:r},o={noDataValue:l?.noDataValue,returnFileInfo:!0};return this.load().then(()=>this._fetchTileAvailability(e,t,i,l)).then(()=>(0,a.A)(this.getTileUrl(e,t,i),s)).then(e=>this._lercDecoder.decode(e.data,o,r)).then(e=>new C.i(e))}getTileUrl(e,t,i){const l=!this.capabilities.operations.supportsTileMap&&this.supportsBlankTile,a=(0,h.x0)({...this.parsedUrl.query,blankTile:!l&&null});return`${this.parsedUrl.path}/tile/${e}/${t}/${i}${a?"?"+a:""}`}async queryElevation(e,t){const{query:l}=await Promise.resolve().then(i.bind(i,80527));return(0,n.Te)(t),l(this,e,t)}async createElevationSampler(e,t){const{createSampler:l}=await Promise.resolve().then(i.bind(i,80527));return(0,n.Te)(t),l(this,e,t)}_fetchTileAvailability(e,t,i,l){return this.tilemapCache?this.tilemapCache.fetchAvailability(e,t,i,l):Promise.resolve("unknown")}async _fetchImageService(e){if(this.sourceJSON)return this.sourceJSON;const t={query:{f:"json",...this.parsedUrl.query},responseType:"json",signal:e},i=await(0,a.A)(this.parsedUrl.path,t);i.ssl&&(this.url=this.url?.replace(/^http:/i,"https:")),this.sourceJSON=i.data,this.read(i.data,{origin:"service",url:this.parsedUrl})}get hasOverriddenFetchTile(){return!this.fetchTile[M]}};(0,l.Cg)([(0,p.MZ)({readOnly:!0})],D.prototype,"capabilities",void 0),(0,l.Cg)([(0,c.w)("service","capabilities",["capabilities"])],D.prototype,"readCapabilities",null),(0,l.Cg)([(0,p.MZ)({json:{read:{source:"copyrightText"}}})],D.prototype,"copyright",void 0),(0,l.Cg)([(0,p.MZ)({readOnly:!0,type:d.A})],D.prototype,"heightModelInfo",void 0),(0,l.Cg)([(0,p.MZ)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],D.prototype,"path",void 0),(0,l.Cg)([(0,p.MZ)({type:["show","hide"]})],D.prototype,"listMode",void 0),(0,l.Cg)([(0,p.MZ)({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}},readOnly:!0})],D.prototype,"minScale",void 0),(0,l.Cg)([(0,p.MZ)({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}},readOnly:!0})],D.prototype,"maxScale",void 0),(0,l.Cg)([(0,p.MZ)({json:{read:!1,write:!1,origins:{"web-document":{read:!1,write:!1}}}})],D.prototype,"opacity",void 0),(0,l.Cg)([(0,p.MZ)({type:["ArcGISTiledElevationServiceLayer"]})],D.prototype,"operationalLayerType",void 0),(0,l.Cg)([(0,p.MZ)()],D.prototype,"sourceJSON",void 0),(0,l.Cg)([(0,p.MZ)({json:{read:!1},value:"elevation",readOnly:!0})],D.prototype,"type",void 0),(0,l.Cg)([(0,p.MZ)(w.OZ)],D.prototype,"url",void 0),(0,l.Cg)([(0,p.MZ)()],D.prototype,"version",void 0),(0,l.Cg)([(0,c.w)("version",["currentVersion"])],D.prototype,"readVersion",null),D=(0,l.Cg)([(0,u.$)("esri.layers.ElevationLayer")],D);const M=Symbol("default-fetch-tile");D.prototype.fetchTile[M]=!0;const S=D},44067:(e,t,i)=>{i.d(t,{A:()=>r});var l=i(50076),a=i(50346);class r{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.lods[e.lods.length-1].level;this.tileInfo=e,this.minLOD=t,this.maxLOD=i,e.lodAt(t)||(this.minLOD=e.lods[0].level),e.lodAt(i)||(this.maxLOD=e.lods[e.lods.length-1].level)}get effectiveMinLOD(){return this.minLOD??this.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??this.tileInfo.lods[this.tileInfo.lods.length-1].level}getAvailability(e,t,i){const l=this.tileInfo?.lodAt(e);return!l||e<this.minLOD||e>this.maxLOD?"unavailable":l.cols&&l.rows?i>=l.cols[0]&&i<=l.cols[1]&&t>=l.rows[0]&&t<=l.rows[1]?"unknown":"unavailable":"unknown"}async fetchAvailability(e,t,i,r){await(0,a.NO)(r);const s=this.getAvailability(e,t,i);if("unavailable"===s)throw new l.A("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:i});return s}async fetchAvailabilityUpsample(e,t,i,l,r){await(0,a.NO)(r),l.level=e,l.row=t,l.col=i;const s=this.tileInfo;return s.updateTileInfo(l),this.fetchAvailability(e,t,i,r).catch(e=>{if((0,a.zf)(e))throw e;if(s.upsampleTile(l))return this.fetchAvailabilityUpsample(l.level,l.row,l.col,l,r);throw e})}}},60883:(e,t,i)=>{i.d(t,{b:()=>s});var l=i(12016);class a extends l.B{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super("LercWorker","_decode",{_decode:e=>[e.buffer]},e,{strategy:"dedicated"}),this.schedule=e,this.ref=0}decode(e,t,i){return e&&0!==e.byteLength?this.invoke({buffer:e,options:t},i):Promise.resolve(null)}release(){--this.ref<=0&&(r.forEach((e,t)=>{e===this&&r.delete(t)}),this.destroy())}}const r=new Map;function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=r.get(e);return t||(null!=e?(t=new a(t=>e.immediate.schedule(t)),r.set(e,t)):(t=new a,r.set(null,t))),++t.ref,t}},76328:(e,t,i)=>{i.d(t,{f:()=>c});var l=i(6326),a=i(46053),r=(i(81806),i(76460),i(47249),i(28379)),s=i(87990),o=i(13312),n=i(88235),h=i(44067),p=i(82356);const c=e=>{const t=e;let i=class extends t{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}destroy(){this.tilemapCache?.destroy?.()}readMinScale(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}readMaxScale(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(e,t,i){const l=t.capabilities?.includes("Tilemap");let{minLOD:a,maxLOD:r,minScale:s,maxScale:o}=t;if(null==a&&null==r&&(0!==s||0!==o)){const e=e=>Math.round(1e4*e)/1e4;s=e(s||t.tileInfo.lods[0].scale),o=e(o||t.tileInfo.lods[t.tileInfo.lods.length-1].scale);for(const i of t.tileInfo.lods){const t=e(i.scale);a=t>=s?i.level:a,r=t>=o?i.level:r}}if(l)return new p.d({layer:this,minLOD:a,maxLOD:r});if(t.tileInfo){const e=new n.A;return e.read(t.tileInfo,i),new h.A(e,a,r)}return null}};return(0,l.Cg)([(0,a.MZ)({json:{read:{source:"copyrightText"}}})],i.prototype,"copyright",void 0),(0,l.Cg)([(0,a.MZ)()],i.prototype,"minScale",void 0),(0,l.Cg)([(0,r.w)("service","minScale")],i.prototype,"readMinScale",null),(0,l.Cg)([(0,a.MZ)()],i.prototype,"maxScale",void 0),(0,l.Cg)([(0,r.w)("service","maxScale")],i.prototype,"readMaxScale",null),(0,l.Cg)([(0,a.MZ)({type:o.A})],i.prototype,"spatialReference",void 0),(0,l.Cg)([(0,a.MZ)({readOnly:!0})],i.prototype,"supportsBlankTile",null),(0,l.Cg)([(0,a.MZ)({type:n.A})],i.prototype,"tileInfo",void 0),(0,l.Cg)([(0,a.MZ)()],i.prototype,"tilemapCache",void 0),(0,l.Cg)([(0,r.w)("service","tilemapCache",["capabilities","tileInfo"])],i.prototype,"readTilemapCache",null),(0,l.Cg)([(0,a.MZ)()],i.prototype,"version",void 0),i=(0,l.Cg)([(0,s.$)("esri.layers.mixins.ArcGISCachedService")],i),i}}}]);
//# sourceMappingURL=23875.bdb92271.chunk.js.map