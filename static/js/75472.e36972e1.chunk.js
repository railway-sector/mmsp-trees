"use strict";(self.webpackChunkmmsp_trees=self.webpackChunkmmsp_trees||[]).push([[75472],{2144:(e,t,i)=>{i.d(t,{b:()=>a});var n=i(18690),r=i(54901),s=i(50346),o=i(75540);class a{constructor(){this._currentOperationSignal=(0,o.v)(null)}get currentOperationType(){return this._currentOperationSignal.value?.type??null}destroy(){this.stop()}async start(e,t,i){const o=this._currentOperationSignal.value;o?.stop();const a=new AbortController,l=i?.signal,u=AbortSignal.any([a.signal,l].filter(n.Ru)),p=(0,s.Tw)();let h=!1;const c=()=>{h||(h=!0,p.reject((0,s.NK)()))},v={type:e,resolve:e=>{h||(h=!0,p.resolve(e))},reject:c,promise:p.promise,stop:()=>a.abort(),handles:[]};this._currentOperationSignal.value=v,v.handles.push((0,s.u7)(l,()=>{a.abort()}),(0,s.u7)(u,()=>{(0,r.a0)(v.handles),h||c()}));try{return o&&(await o.promise.catch(()=>{}),(0,s.Te)(u)),await t(v,u),await p.promise}finally{(0,r.a0)(v.handles),this._currentOperationSignal.value===v&&(this._currentOperationSignal.value=null)}}stop(){this._currentOperationSignal.value?.stop()}}},38983:(e,t,i)=>{function n(e,t,i){i=i||2;var n,s,a,l,u,p,c,v=t&&t.length,d=v?t[0]*i:e.length,y=r(e,0,d,i,!0),g=[];if(!y||y.next===y.prev)return g;if(v&&(y=h(e,t,y,i)),e.length>80*i){n=a=e[0],s=l=e[1];for(var f=i;f<d;f+=i)(u=e[f])<n&&(n=u),(p=e[f+1])<s&&(s=p),u>a&&(a=u),p>l&&(l=p);c=0!==(c=Math.max(a-n,l-s))?1/c:0}return o(y,g,i,n,s,c),g}function r(e,t,i,n,r){var s,o;if(r===G(e,t,i,n)>0)for(s=t;s<i;s+=n)o=P(s,e[s],e[s+1],o);else for(s=i-n;s>=t;s-=n)o=P(s,e[s],e[s+1],o);if(o&&C(o,o.next)){var a=o.next;E(o),o=a}return o}function s(e,t){if(!e)return e;t||(t=e);var i,n=e;do{if(i=!1,n.steiner||!C(n,n.next)&&0!==w(n.prev,n,n.next))n=n.next;else{var r=n.prev;if(E(n),(n=t=r)===n.next)break;i=!0}}while(i||n!==t);return t}function o(e,t,i,n,r,h,c){if(e){!c&&h&&g(e,n,r,h);for(var v,d,y=e;e.prev!==e.next;)if(v=e.prev,d=e.next,h?l(e,n,r,h):a(e))t.push(v.i/i),t.push(e.i/i),t.push(d.i/i),E(e),e=d.next,y=d.next;else if((e=d)===y){c?1===c?o(e=u(s(e),t,i),t,i,n,r,h,2):2===c&&p(e,t,i,n,r,h):o(s(e),t,i,n,r,h,1);break}}}function a(e){var t=e.prev,i=e,n=e.next;if(w(t,i,n)>=0)return!1;for(var r=e.next.next;r!==e.prev;){if(_(t.x,t.y,i.x,i.y,n.x,n.y,r.x,r.y)&&w(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function l(e,t,i,n){var r=e.prev,s=e,o=e.next;if(w(r,s,o)>=0)return!1;for(var a=r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,l=r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,u=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,p=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,h=f(a,l,t,i,n),c=f(u,p,t,i,n),v=e.prevZ,d=e.nextZ;v&&v.z>=h&&d&&d.z<=c;){if(v!==e.prev&&v!==e.next&&_(r.x,r.y,s.x,s.y,o.x,o.y,v.x,v.y)&&w(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,d!==e.prev&&d!==e.next&&_(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&w(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;v&&v.z>=h;){if(v!==e.prev&&v!==e.next&&_(r.x,r.y,s.x,s.y,o.x,o.y,v.x,v.y)&&w(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;d&&d.z<=c;){if(d!==e.prev&&d!==e.next&&_(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&w(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function u(e,t,i){var n=e;do{var r=n.prev,o=n.next.next;!C(r,o)&&b(r,n,n.next,o)&&S(r,o)&&S(o,r)&&(t.push(r.i/i),t.push(n.i/i),t.push(o.i/i),E(n),E(n.next),n=e=o),n=n.next}while(n!==e);return s(n)}function p(e,t,i,n,r,a){var l=e;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&x(l,u)){var p=k(l,u);return l=s(l,l.next),p=s(p,p.next),o(l,t,i,n,r,a),void o(p,t,i,n,r,a)}u=u.next}l=l.next}while(l!==e)}function h(e,t,i,n){var o,a,l,u=[];for(o=0,a=t.length;o<a;o++)(l=r(e,t[o]*n,o<a-1?t[o+1]*n:e.length,n,!1))===l.next&&(l.steiner=!0),u.push(m(l));for(u.sort(c),o=0;o<u.length;o++)i=s(i=d(u[o],i),i.next);return i}function c(e,t){return e.x-t.x}function v(e){if(e.next.prev===e)return e;let t=e;for(;;){const i=t.next;if(i.prev===t||i===t||i===e)break;t=i}return t}function d(e,t){var i=function(e,t){var i,n=t,r=e.x,s=e.y,o=-1/0;do{if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){var a=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>o){if(o=a,a===r){if(s===n.y)return n;if(s===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!i)return null;if(r===o)return i;var l,u=i,p=i.x,h=i.y,c=1/0;n=i;do{r>=n.x&&n.x>=p&&r!==n.x&&_(s<h?r:o,s,p,h,s<h?o:r,s,n.x,n.y)&&(l=Math.abs(s-n.y)/(r-n.x),S(n,e)&&(l<c||l===c&&(n.x>i.x||n.x===i.x&&y(i,n)))&&(i=n,c=l)),n=n.next}while(n!==u);return i}(e,t);if(!i)return t;var n=k(i,e),r=s(i,i.next);let o=v(n);return s(o,o.next),r=v(r),v(t===i?r:t)}function y(e,t){return w(e.prev,e,t.prev)<0&&w(t.next,e,e.next)<0}function g(e,t,i,n){var r=e;do{null===r.z&&(r.z=f(r.x,r.y,t,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){var t,i,n,r,s,o,a,l,u=1;do{for(i=e,e=null,s=null,o=0;i;){for(o++,n=i,a=0,t=0;t<u&&(a++,n=n.nextZ);t++);for(l=u;a>0||l>0&&n;)0!==a&&(0===l||!n||i.z<=n.z)?(r=i,i=i.nextZ,a--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:e=r,r.prevZ=s,s=r;i=n}s.nextZ=null,u*=2}while(o>1)}(r)}function f(e,t,i,n,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function m(e){var t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function _(e,t,i,n,r,s,o,a){return(r-o)*(t-a)-(e-o)*(s-a)>=0&&(e-o)*(n-a)-(i-o)*(t-a)>=0&&(i-o)*(s-a)-(r-o)*(n-a)>=0}function x(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&b(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&(S(e,t)&&S(t,e)&&function(e,t){var i=e,n=!1,r=(e.x+t.x)/2,s=(e.y+t.y)/2;do{i.y>s!=i.next.y>s&&i.next.y!==i.y&&r<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==e);return n}(e,t)&&(w(e.prev,e,t.prev)||w(e,t.prev,t))||C(e,t)&&w(e.prev,e,e.next)>0&&w(t.prev,t,t.next)>0)}function w(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function C(e,t){return e.x===t.x&&e.y===t.y}function b(e,t,i,n){var r=Z(w(e,t,i)),s=Z(w(e,t,n)),o=Z(w(i,n,e)),a=Z(w(i,n,t));return r!==s&&o!==a||!(0!==r||!M(e,i,t))||!(0!==s||!M(e,n,t))||!(0!==o||!M(i,e,n))||!(0!==a||!M(i,t,n))}function M(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function Z(e){return e>0?1:e<0?-1:0}function S(e,t){return w(e.prev,e,e.next)<0?w(e,t,e.next)>=0&&w(e,e.prev,t)>=0:w(e,t,e.prev)<0||w(e,e.next,t)<0}function k(e,t){var i=new R(e.i,e.x,e.y),n=new R(t.i,t.x,t.y),r=e.next,s=t.prev;return e.next=t,t.prev=e,i.next=r,r.prev=i,n.next=i,i.prev=n,s.next=n,n.prev=s,n}function P(e,t,i,n){var r=new R(e,t,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function E(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function R(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function G(e,t,i,n){for(var r=0,s=t,o=i-n;s<i;s+=n)r+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return r}i.d(t,{e:()=>n}),n.deviation=function(e,t,i,n){var r=t&&t.length,s=r?t[0]*i:e.length,o=Math.abs(G(e,0,s,i));if(r)for(var a=0,l=t.length;a<l;a++){var u=t[a]*i,p=a<l-1?t[a+1]*i:e.length;o-=Math.abs(G(e,u,p,i))}var h=0;for(a=0;a<n.length;a+=3){var c=n[a]*i,v=n[a+1]*i,d=n[a+2]*i;h+=Math.abs((e[c]-e[d])*(e[v+1]-e[c+1])-(e[c]-e[v])*(e[d+1]-e[c+1]))}return 0===o&&0===h?0:Math.abs((h-o)/o)},n.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},n=0,r=0;r<e.length;r++){for(var s=0;s<e[r].length;s++)for(var o=0;o<t;o++)i.vertices.push(e[r][s][o]);r>0&&(n+=e[r-1].length,i.holes.push(n))}return i}},40615:(e,t,i)=>{i.d(t,{Q:()=>f});var n=i(6326),r=i(91967),s=i(68134),o=i(46053),a=(i(81806),i(76460),i(47249),i(87990)),l=i(45564),u=i(69098),p=i(56002),h=i(19247),c=i(57919),v=i(31633);function d(e,t,i){return null==e?null:(0,v.oU)(e*t,"meters",i)}function y(e,t,i){return null==e?null:(0,v.oU)(e*t,"meters",i)}let g=class extends u.Pw{constructor(e){super(e),this._getSamplesMemoized=(0,p.B)((e,t)=>function(e,t){if(null==e||null==t)return null;const{samples:i,spatialReference:n}=e,{distance:r,elevation:s}=t,o=(0,v.GA)(n),a=(0,v.G9)(n),l=i.length,u=new Array(l);for(let p=0;p<l;++p){const e=i[p],t=e.sampledZ,n=e.coordinate;u[p]={x:n[0],y:n[1],z:t,distance:d(e.distance,o,r),elevation:y(t,a,s)}}return u}(e,t)),this._getStatisticsMemoized=(0,p.B)((e,t)=>function(e,t){if(null==e||null==t||null==e.statistics||null==e.spatialReference)return null;const{distance:i,elevation:n}=t,{statistics:r,spatialReference:s}=e,o=(0,v.GA)(s),a=(0,v.G9)(s);return{maxDistance:d(r.maxDistance,o,i),minElevation:y(r.minElevation,a,n),maxElevation:y(r.maxElevation,a,n),avgElevation:y(r.avgElevation,a,n),elevationGain:y(r.elevationGain,a,n),elevationLoss:y(r.elevationLoss,a,n),maxPositiveSlope:r.maxPositiveSlope,maxNegativeSlope:r.maxNegativeSlope,avgPositiveSlope:r.avgPositiveSlope,avgNegativeSlope:r.avgNegativeSlope}}(e,t)),this.rawResult=null}get available(){const{computation:e}=this;return e.profile.enabled&&e.available}get profile(){return this.computation.profile}get progress(){return(0,c.xi)(null!=this.rawResult&&this.computation.profile.enabled?this.rawResult.progress:0)}get samples(){return this._getSamplesMemoized(this.rawResult,this.computation.controller.effectiveDisplayUnits)}get statistics(){return this._getStatisticsMemoized(this.rawResult,this.computation.controller.effectiveDisplayUnits)}get hoveredPoint(){if(!this.computation.profile.enabled)return null;const e=this.computation.controller.analysisViewData.hoveredPosition;if(null==e)return null;const{rawResult:t,samples:i}=this;if(null==i||null==t)return null;const n=i.length;if(0===n)return null;const r=i[n-1].distance,s=(0,c.qX)(i,e*r,e=>e.distance);if(null==s)return null;const{x:o,y:a,z:l}=s;return null==l?null:new h.A({x:o,y:a,z:l,spatialReference:t.spatialReference})}};(0,n.Cg)([(0,o.MZ)()],g.prototype,"available",null),(0,n.Cg)([(0,o.MZ)({readOnly:!0})],g.prototype,"profile",null),(0,n.Cg)([(0,o.MZ)({readOnly:!0})],g.prototype,"progress",null),(0,n.Cg)([(0,o.MZ)()],g.prototype,"samples",null),(0,n.Cg)([(0,o.MZ)()],g.prototype,"statistics",null),(0,n.Cg)([(0,o.MZ)({constructOnly:!0})],g.prototype,"computation",void 0),(0,n.Cg)([(0,o.MZ)()],g.prototype,"rawResult",void 0),(0,n.Cg)([(0,o.MZ)()],g.prototype,"hoveredPoint",null),g=(0,n.Cg)([(0,a.$)("esri.views.analysis.ElevationProfile.ElevationProfileResult")],g);let f=class extends r.A{constructor(e){super(e),this.result=new g({computation:this}),this.numSamplesForPreview=30,this.numSamplesPerChunk=200}initialize(){this.addHandles([(0,s.wB)(()=>{const{geometry:e,elevationInfo:t}=this.controller.analysis;return[e,t]},()=>this.onInvalidate(this),s.OH)])}setResult(e){this.result.rawResult=e}clearResult(){this.setResult(null)}get progress(){return this.result.progress}get hoveredPoint(){return this.result.hoveredPoint}get available(){return!0}get minDemResolution(){return(0,l.zj)().defaultDemResolution}};(0,n.Cg)([(0,o.MZ)({constructOnly:!0})],f.prototype,"controller",void 0),(0,n.Cg)([(0,o.MZ)({constructOnly:!0})],f.prototype,"profile",void 0),(0,n.Cg)([(0,o.MZ)({constructOnly:!0})],f.prototype,"onInvalidate",void 0),(0,n.Cg)([(0,o.MZ)()],f.prototype,"result",void 0),(0,n.Cg)([(0,o.MZ)({readOnly:!0})],f.prototype,"progress",null),(0,n.Cg)([(0,o.MZ)()],f.prototype,"hoveredPoint",null),(0,n.Cg)([(0,o.MZ)()],f.prototype,"available",null),(0,n.Cg)([(0,o.MZ)()],f.prototype,"numSamplesForPreview",void 0),(0,n.Cg)([(0,o.MZ)()],f.prototype,"numSamplesPerChunk",void 0),(0,n.Cg)([(0,o.MZ)({readOnly:!0})],f.prototype,"minDemResolution",null),f=(0,n.Cg)([(0,a.$)("esri.views.analysis.ElevationProfile.ElevationProfileLineComputation")],f)},43825:(e,t,i)=>{i.d(t,{V:()=>P});var n=i(6326),r=i(91967),s=i(18690),o=i(98773),a=i(80674),l=i(54901),u=i(53084),p=i(53521),h=i(43927),c=i(30726),v=i(50346),d=i(68134),y=i(79468),g=i(31633),f=i(46053),m=(i(81806),i(76460),i(87990)),_=i(71630),x=i(12482),w=i(19747),C=i(731),b=i(45564),M=i(27631),Z=i(47453),S=i(57919),k=i(80397);let P=class extends r.A{constructor(e){super(e),this.error=null,this._getStableEffectiveUnits=(0,a.f)(()=>{const e=(0,k.DM)(this._activeComputations.map(e=>e.result.rawResult)),t=this.analysis.displayUnits,i=(0,w.c)(this.view);return{distance:(0,g.Vs)(e.maxDistance,"meters",t.distance??i),elevation:(0,g.jE)(e.maxElevation,"meters",t.elevation??i)}},u.gh),this._updateTask=null,this._queue=null,this._currentTileCache=null,this._parametersPerComputation=new Map,this._getStableUpdateParameters=(0,a.f)(()=>({stationary:this.view.stationary??!0,activeComputations:this._activeComputations,generationParameters:this._generationParameters}),u.gh),this._getStableGenerationParameters=(0,a.f)(()=>{const{view:e,analysis:t}=this;return e?.ready&&this._queue?{view:e,geometry:t.geometry,geometryIsValid:t.valid,elevationInfo:this.elevationInfo,queue:this._queue,cache:this._tileCache,options:this._options,slicePlane:"3d"===e.type?e.slice.plane:null}:null},u.gh),this._getStableElevationInfo=(0,a.f)(()=>this.analysis.elevationInfo??E,c.CM),this._getStableOptions=(0,a.f)(()=>{const{densificationMaxSamples:e,defaultDemResolution:t,maxTotalSamples:i}=(0,b.zj)();let n=this._minDemResolution??t;return n=parseFloat(n.toFixed(2)),{samplingDistance:n,densificationMaxSamples:Math.round(e/this._activeComputations.length),maxTotalSamples:i}},u.gh),this._updateThrottled=(0,y.n)(e=>this._update(e),(0,b.zj)().updateThrottleMillis)}initialize(){this._computationsCollection=(0,h.L)(()=>this.analysis.profiles,e=>this.computationFactory.create({controller:this,profile:e,onInvalidate:e=>this._invalidateComputation(e)}),{recycleItems:!0}),this.addHandles([this._computationsCollection.on("change",()=>{this._parametersPerComputation.clear(),this._updateThrottled(this._updateParameters)}),(0,d.wB)(()=>this._updateParameters,e=>this._updateThrottled(e),d.pc),this._updateThrottled]);const e="3d"===this.view.type?this.view.resourceController:void 0;this._queue=(0,S.LD)(e?.scheduler),e?.addUpdatingObject(this)}destroy(){this._abortUpdate(),this._parametersPerComputation.clear(),this._computationsCollection?.destroy(),this._queue=(0,c.pR)(this._queue),this._currentTileCache=(0,c.pR)(this._currentTileCache)}get effectiveDisplayUnits(){return this._getStableEffectiveUnits()}get progress(){let e=0,t=0;for(const i of this._activeComputations)e++,t+=i.progress;return(0,S.xi)(e>0?t/e:0)}get updating(){const{progress:e}=this,t=!!this._queue?.updating,i=this._updateThrottled.hasPendingUpdates(),n=null!=this._updateTask&&!this._updateTask.finished;return t||i||n||e>0&&e<1}get results(){return this._computations.map(e=>e.result)}get statistics(){return(0,k.ch)(this._activeComputations.map(e=>e.result.statistics))}get hoveredPoints(){return this._computations.map(e=>e.hoveredPoint)}onElevationChange(e){const{view:t}=this;return"3d"===t?.type?(0,d.on)(()=>t.elevationProvider,"elevation-change",e,{onListenerAdd:e,onListenerRemove:e}):(0,l.hA)()}get _tileCache(){this._currentTileCache=(0,c.pR)(this._currentTileCache);const e=this.view;if("3d"===e?.type){const t=e.basemapTerrain?.elevationQueryCache;if(null!=t)return t}return null==this._currentTileCache&&(this._currentTileCache=new _.E(new p.q(20971520))),this._currentTileCache}get _computations(){return this._computationsCollection?.toArray()??[]}get _activeComputations(){return this._computations.filter(e=>e.profile.enabled&&e.available)}get _minDemResolution(){const e=this._minDemResolutions;return e.length>0?(0,s.jk)(e):null}get _minDemResolutions(){const e=[];for(const{minDemResolution:t}of this._activeComputations)null!=t&&e.push(t);return e}get _updateParameters(){return this._getStableUpdateParameters()}get _generationParameters(){return this._getStableGenerationParameters()}get elevationInfo(){return this._getStableElevationInfo()}get _options(){return this._getStableOptions()}_update(e){let{stationary:t,activeComputations:i,generationParameters:n}=e;this._abortUpdate(),t&&(null!=n?this._updateTask=(0,o.UT)(async e=>{this.error=null;const t=i.filter(e=>!this._isComputationValid(e,n));try{if(!n.geometryIsValid)throw new Z.ON;const i=(0,S.uK)({...n,providers:t},{signal:e});let r=!1;for await(const s of i){(0,v.Te)(e),r||(this._clearInvalidResults(n),r=!0);for(let e=0;e<t.length;e++)t[e].setResult(s[e])}for(const e of t)this._parametersPerComputation.set(e,n)}catch(r){(0,v.QP)(r),this._abortUpdate(),this.error=r instanceof M.A?r:new Z.Bk,t.forEach(e=>{e.clearResult()})}}):this._clearResults())}_abortUpdate(){this._updateTask=(0,c.DC)(this._updateTask)}_isComputationValid(e,t){return this._parametersPerComputation.has(e)&&this._parametersPerComputation.get(e)===t}_invalidateComputation(e){this._parametersPerComputation.delete(e),this._updateThrottled(this._updateParameters)}_clearInvalidResults(e){for(const t of this._computations)this._isComputationValid(t,e)||(t.clearResult(),this._parametersPerComputation.delete(t))}_clearResults(){for(const e of this._computations)e.clearResult(),this._parametersPerComputation.delete(e)}};(0,n.Cg)([(0,f.MZ)({constructOnly:!0})],P.prototype,"analysis",void 0),(0,n.Cg)([(0,f.MZ)({constructOnly:!0})],P.prototype,"analysisViewData",void 0),(0,n.Cg)([(0,f.MZ)({constructOnly:!0})],P.prototype,"computationFactory",void 0),(0,n.Cg)([(0,f.MZ)({constructOnly:!0})],P.prototype,"view",void 0),(0,n.Cg)([(0,f.MZ)()],P.prototype,"error",void 0),(0,n.Cg)([(0,f.MZ)({readOnly:!0})],P.prototype,"effectiveDisplayUnits",null),(0,n.Cg)([(0,f.MZ)()],P.prototype,"progress",null),(0,n.Cg)([(0,f.MZ)()],P.prototype,"updating",null),(0,n.Cg)([(0,f.MZ)()],P.prototype,"results",null),(0,n.Cg)([(0,f.MZ)()],P.prototype,"statistics",null),(0,n.Cg)([(0,f.MZ)()],P.prototype,"hoveredPoints",null),(0,n.Cg)([(0,f.MZ)()],P.prototype,"_updateTask",void 0),(0,n.Cg)([(0,f.MZ)()],P.prototype,"_queue",void 0),(0,n.Cg)([(0,f.MZ)()],P.prototype,"_tileCache",null),(0,n.Cg)([(0,f.MZ)()],P.prototype,"_computationsCollection",void 0),(0,n.Cg)([(0,f.MZ)()],P.prototype,"_computations",null),(0,n.Cg)([(0,f.MZ)()],P.prototype,"_activeComputations",null),(0,n.Cg)([(0,f.MZ)({readOnly:!0})],P.prototype,"_minDemResolution",null),(0,n.Cg)([(0,f.MZ)()],P.prototype,"_minDemResolutions",null),(0,n.Cg)([(0,f.MZ)()],P.prototype,"_updateParameters",null),(0,n.Cg)([(0,f.MZ)()],P.prototype,"_generationParameters",null),(0,n.Cg)([(0,f.MZ)()],P.prototype,"elevationInfo",null),(0,n.Cg)([(0,f.MZ)()],P.prototype,"_options",null),P=(0,n.Cg)([(0,m.$)("esri.views.analysis.ElevationProfile.ElevationProfileController")],P);const E=new C.A({...x.qt})},49636:(e,t,i)=>{i.d(t,{s:()=>u});var n=i(6326),r=i(68134),s=i(46053),o=(i(81806),i(76460),i(47249),i(87990)),a=i(40615),l=i(61607);let u=class extends a.Q{constructor(){super(...arguments),this.type="query",this.numSamplesForPreview=50,this.numSamplesPerChunk=500}get minDemResolution(){return(0,l.e)(this.profile.source)}get available(){const{source:e}=this.profile;return!!e&&(null==e.visible||e.visible)&&(null==e.layers||e.layers.some(e=>e.visible))}initialize(){this.addHandles((0,r.wB)(()=>this.profile.source,()=>this.onInvalidate(this),r.OH))}queryElevation(e,t){if(!this.profile.source)throw new Error("No source configured for the elevation profile line");return this.profile.source.queryElevation(e,t)}};(0,n.Cg)([(0,s.MZ)({readOnly:!0})],u.prototype,"minDemResolution",null),(0,n.Cg)([(0,s.MZ)()],u.prototype,"available",null),u=(0,n.Cg)([(0,o.$)("esri.views.analysis.ElevationProfile.ElevationProfileLineQueryComputation")],u)},49853:(e,t,i)=>{i.d(t,{a:()=>u});var n=i(6326),r=i(54099),s=i(54901),o=i(91291),a=i(46053),l=(i(81806),i(76460),i(47249),i(87990));let u=class extends((0,o.g)(r.nJ)){constructor(){super(...arguments),this.parent=null,this._userInteractive=!1,this._interactiveViewModelCount=0}get interactive(){return this._interactiveViewModelCount>0||this._userInteractive}set interactive(e){this._userInteractive=e}get updating(){return!1}get visible(){return(this.parent?.visible&&!this.parent.suspended)??!0}set visible(e){this._overrideIfSome("visible",e)}forceInteractive(){return this._interactiveViewModelCount++,(0,s.hA)(()=>this._interactiveViewModelCount--)}};(0,n.Cg)([(0,a.MZ)({constructOnly:!0})],u.prototype,"parent",void 0),(0,n.Cg)([(0,a.MZ)({constructOnly:!0})],u.prototype,"view",void 0),(0,n.Cg)([(0,a.MZ)({type:Boolean})],u.prototype,"interactive",null),(0,n.Cg)([(0,a.MZ)()],u.prototype,"_userInteractive",void 0),(0,n.Cg)([(0,a.MZ)({readOnly:!0})],u.prototype,"updating",null),(0,n.Cg)([(0,a.MZ)()],u.prototype,"visible",null),(0,n.Cg)([(0,a.MZ)()],u.prototype,"_interactiveViewModelCount",void 0),u=(0,n.Cg)([(0,l.$)("esri.views.analysis.AnalysisView")],u)},55980:(e,t,i)=>{i.d(t,{T:()=>r});var n=i(48384);function r(e,t){e??=[];const i=e.length-1,r=[];let s=[];for(let n=0;n<=i;n++){const{x:t,y:o,z:a}=e[n];null!=a&&s.push([t,o,a]),n!==i&&null!=a||!s.length||(r.push(s),s=[])}return(0,n.LZ)(r,t,!0)}},61607:(e,t,i)=>{i.d(t,{W:()=>a,e:()=>o});var n=i(18690),r=i(31633),s=i(97153);function o(e){if(null==e)return null;if((0,s.Q)(e))return a(e);const t=e.tileInfo;if(null==t)return null;const i=t.lods?.at(-1);return null==i?null:i.resolution*(0,r.GA)(t.spatialReference)}function a(e){if(null==e)return null;const t=e.layers.items.map(l).filter(n.Ru);return(0,n.jk)(t)??null}function l(e){return e&&"tileInfo"in e?o(e):null}},62068:(e,t,i)=>{i.d(t,{o:()=>v});var n=i(6326),r=i(80674),s=i(53084),o=i(30726),a=i(68134),l=i(46053),u=(i(81806),i(76460),i(87990)),p=i(62078),h=i(80635),c=i(40615);let v=class extends c.Q{constructor(){super(...arguments),this.type="input",this.numSamplesForPreview=50,this.numSamplesPerChunk=500,this._getStableElevationDependencies=(0,r.f)(()=>{const{view:e}=this.controller;if(!e)return null;const t=this._getStableElevationInfo();return{view:e,stationary:!this._requiresElevationAlignment||e.stationary,elevationInfo:t,visibleLayerIds:this._getStableLayerIds(),spatialReference:this._getStableSpatialReference()}},s.gh),this._getStableElevationInfo=(0,r.f)(()=>this.controller.elevationInfo,o.CM),this._getStableSpatialReference=(0,r.f)(()=>this.controller.view?.spatialReference,o.CM),this._getStableLayerIds=(0,r.f)(()=>{const{view:e}=this.controller;return"3d"!==e.type?[]:(0,h.Y)(e)},s.gh)}initialize(){const e=()=>this.onInvalidate(this);this.addHandles([(0,a.wB)(()=>this._queryElevationDependencies,e,a.OH),this.controller.onElevationChange(e)])}async queryElevation(e,t){let{noDataValue:i,signal:n}=t;const r=this._queryElevationDependencies;if(null==r)throw new Error(`${this.declaredClass}: no dependencies`);const{view:s,spatialReference:o}=r;if(this._requiresElevationAlignment&&"3d"===s.type&&o){const t=await p.q.fromGeometry(e).project(o,n);if(!t)return{geometry:e,noDataValue:i};const r=s.elevationProvider;return t.coordinates.forEach(e=>{e.z=r.getElevation(e.x,e.y,0,o,"ground")??0}),{geometry:t.export(),noDataValue:i}}return{geometry:e,noDataValue:i}}get _requiresElevationAlignment(){return"on-the-ground"===this.controller.elevationInfo?.mode&&"3d"===this.controller.view.type}get _queryElevationDependencies(){return this._getStableElevationDependencies()}};(0,n.Cg)([(0,l.MZ)()],v.prototype,"_queryElevationDependencies",null),v=(0,n.Cg)([(0,u.$)("esri.views.analysis.ElevationProfile.ElevationProfileLineInputComputation")],v)},71143:(e,t,i)=>{i.d(t,{R:()=>Z});var n=i(6326),r=i(39356),s=i(91967),o=i(98773),a=i(19276),l=(i(81806),i(54901)),u=i(30726),p=i(50346),h=i(68134),c=i(46053),v=(i(76460),i(47249),i(87990)),d=i(19451),y=i(63733),g=i(12482),f=i(89465),m=i(7246),_=i(731),x=i(2144),w=i(55964),C=i(57308),b=i(81335),M=i(18279);let Z=class extends s.A{constructor(e){super(e),this._sketchViewModels=new a.A,this._updatingHandles=new d.U,this._operationManager=new x.b}initialize(){const{view:e}=this;this._graphicsLayer=new y.A({listMode:"hide",internal:!0}),this.addHandles([(0,h.wB)(()=>({map:e.map,internalGraphicsLayer:this._graphicsLayer,state:this.state,geometryVisualizationVisible:this._analysis.viewOptions.geometryVisualizationVisible,visible:this.analysisViewData.visible}),e=>{let{map:t,internalGraphicsLayer:i,state:n,geometryVisualizationVisible:r,visible:s}=e;!function(e,t){t&&(t.removeFromParent(),e?.add(t))}(t,i);const o=this.sketchGraphic;switch(o&&(o.visible=s),n){case"idle":case"reshaping-disabled":o&&!r&&(o.visible=!1),this._operationManager.stop(),this._ensureUpdatedSketchGraphic();break;case"reshaping":(0,p.QZ)(this._startReshape());break;case"awaiting-sketch":this.analysisViewData.interactive=!0}},h.pc),(0,h.wB)(()=>this._analysis.elevationInfo,e=>{this._graphicsLayer.elevationInfo=e},h.pc)])}destroy(){this._operationManager.destroy(),this._sketchViewModels.drain(e=>(0,u.pR)(e));const e=this._graphicsLayer;this.view.map?.remove(e),e.destroy()}get sketchGraphic(){return this._get("sketchGraphic")}set sketchGraphic(e){e!==this._get("sketchGraphic")&&(this._set("sketchGraphic",e),this._updateAnalysisFromSketchGraphic())}get state(){const{visible:e,interactive:t}=this.analysisViewData;if(!e)return"idle";switch(this._operationManager.currentOperationType){case"place":return this._sketching?"sketching":"awaiting-sketch";case"pick-feature":return"picking";default:return this._analysis.geometry?t?"reshaping":"reshaping-disabled":"idle"}}get updating(){return this._sketchViewModels.some(e=>e.updating)||this._updatingHandles.updating}get _sketching(){return this._sketchViewModels.some(e=>e.createGraphic===this.sketchGraphic)}get _analysis(){return this.analysisViewData.analysis}get _lineSymbol(){return function(e){if("2d"===e){const e={type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5};return new f.A({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{...e,effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[5,4],lineDashEnding:"FullGap",controlPointEnding:"NoConstraint"}],color:[0,0,0,255]},{...e,color:[255,255,255,255]}]}}})}return new m.A({color:[0,0,0,0]})}(this.view.type)}place(e){return this._operationManager.start("place",async t=>{const i=this._createSketchViewModel(),n=this._analysis.clone();this._ensureUpdatedSketchGraphic();const r=this.sketchGraphic,s=this._analysis.elevationInfo,o=(0,l.hA)(()=>{this.sketchGraphic===r&&(this._graphicsLayer.elevationInfo=s)}),a=i.on("create",e=>{switch(e.state){case"start":this._graphicsLayer.removeAll(),this.sketchGraphic=e.graphic,this._analysis.elevationInfo=this._graphicsLayer.elevationInfo;break;case"active":this._updateAnalysisFromSketchGraphic();break;case"complete":this.sketchGraphic&&(this._updateAnalysisFromSketchGraphic(),this._addSketchGraphic(this.sketchGraphic)),t.stop();break;case"cancel":t.stop()}});t.handles.push(a,(0,l.hA)(()=>(a.remove(),i.destroy(),this._sketchViewModels.remove(i),this._updateAnalysisFromSketchGraphic(),this._analysis.valid?(0,p.G4)(e)||n.equals(this._analysis)?t.reject():void t.resolve({}):(this._clear(),t.reject()))),o),this._graphicsLayer.elevationInfo=S,await this._updatingHandles.addPromise((0,p.QZ)(i.create("polyline")))},e)}async pickFeature(e){return this._operationManager.start("pick-feature",async e=>{const{view:t}=this;t.closePopup();let i=null;e.handles.push(t.on("immediate-click",n=>{n.defer(async()=>{i?.abort(),i=(0,o.UT)(async i=>{const{results:r}=await t.hitTest(n);(0,p.Te)(i);let s=null;for(const e of r)if("graphic"===e.type&&(0,w.lM)(e.graphic)&&!(0,w._W)(e.graphic)){s=e.graphic;break}s?(n.preventDefault(),n.stopPropagation(),this.sketchGraphic=null,this._analysis.geometry=s.geometry,this._analysis.elevationInfo=new _.A({...(0,g.bh)(s)}),e.resolve({feature:s}),e.stop()):e.reject()}),await i.promise})},C.oj.TOOL),t.on("key-down",t=>{(0,b.$X)(t)&&(e.reject(),e.stop())},C.oj.TOOL),t.acquireCursor("crosshair","high"),(0,l.hA)(()=>{i?.abort(),e.reject()})),t.focus()},e)}_startReshape(){const e=this._createSketchViewModel();return this._sketchViewModels.add(e),this._operationManager.start("reshape",async t=>{const i=()=>{const t=this._ensureUpdatedSketchGraphic();return t?this._updatingHandles.addPromise(e.update(t,{tool:"reshape"})):Promise.resolve()};if(!this._ensureUpdatedSketchGraphic())return;const n=e.on("update",e=>{this._updateAnalysisFromSketchGraphic(),"complete"===e.state&&("reshaping"===this.state?(0,p.QZ)(i()):t.resolve())});t.handles.push(n,(0,l.hA)(()=>{n.remove(),this._sketchViewModels.remove(e),e.destroy(),t.resolve()})),await i()})}_createSketchViewModel(){return new M.A({layer:this._graphicsLayer,view:this.view,defaultCreateOptions:{mode:"click",hasZ:!0},updateOnGraphicClick:!1,defaultUpdateOptions:{enableMoveAllGraphics:!1,enableRotation:!1,enableScaling:!1,enableZ:!1,highlightOptions:{enabled:!1},multipleSelectionEnabled:!1,reshapeOptions:{shapeOperation:"none"},toggleToolOnClick:!1,tool:"reshape"},polylineSymbol:this._lineSymbol,activeLineSymbol:this._lineSymbol})}_ensureUpdatedSketchGraphic(){const{geometry:e}=this._analysis;if(!e)return this.sketchGraphic=null,this._graphicsLayer.removeAll(),null;const t=this.sketchGraphic??=new r.A({symbol:this._lineSymbol,geometry:e});return t.geometry=e,this._addSketchGraphic(t),t}_addSketchGraphic(e){const{graphics:t}=this._graphicsLayer;t.includes(e)||t.add(e),1!==t.length&&t.removeMany(t.filter(t=>t!==e))}_clear(){this.sketchGraphic=null,this._analysis.clear()}_updateAnalysisFromSketchGraphic(){let e=this.sketchGraphic?.geometry;(0,w.Rg)(e)||(e=null);const t=this._analysis;t.geometry!==e&&(t.geometry=e)}};(0,n.Cg)([(0,c.MZ)({constructOnly:!0})],Z.prototype,"analysisViewData",void 0),(0,n.Cg)([(0,c.MZ)({constructOnly:!0})],Z.prototype,"view",void 0),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"sketchGraphic",null),(0,n.Cg)([(0,c.MZ)({nonNullable:!0})],Z.prototype,"state",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"updating",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"_sketching",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"_analysis",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"_lineSymbol",null),Z=(0,n.Cg)([(0,v.$)("esri.views.analysis.ElevationProfile.ElevationProfileTool")],Z);const S=new _.A({mode:"on-the-ground",offset:0})},73520:(e,t,i)=>{i.d(t,{V:()=>s});var n=i(54901),r=i(68134);function s(e){return(0,n.vE)([(0,r.wB)(()=>{const{analysis:t,sketchGraphic:i,toolState:n,visible:r}=e.analysisViewData,{geometryVisualizationVisible:s}=t.viewOptions;return{geometryVisualizationVisible:s,geometry:t.geometry,sketchGraphic:i,toolState:n,visible:r}},t=>{let{geometryVisualizationVisible:i,sketchGraphic:n,toolState:r,visible:s}=t;if(e.remove(),s)return i&&null!=n&&"reshaping"!==r&&"sketching"!==r?e.show(n):void 0},r.pc)])}},79468:(e,t,i)=>{i.d(t,{n:()=>r});var n=i(75540);function r(e,t,i,r){let s=null,o=1e3;"number"==typeof t?(o=t,r=i):(s=t??null,o=i);const a=(0,n.v)(0);let l;const u=()=>{a.value=0,e.apply(r,l)},p=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];s&&s.apply(r,t),l=t,o?a.value||(a.value=setTimeout(u,o)):u()};return p.remove=()=>{a.value&&(clearTimeout(a.value),a.value=0)},p.forceUpdate=()=>{a.value&&(clearTimeout(a.value),u())},p.hasPendingUpdates=()=>!!a.value,p}},80635:(e,t,i)=>{function n(e){return e?.map?.allLayers?.toArray().filter(e=>("graphics"!==e.type||!e.internal)&&e.visible).map(e=>e.uid)??[]}i.d(t,{Y:()=>n})},80674:(e,t,i)=>{function n(e,t){let i,n=!1;return function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];const a=e.apply(this,s);return n&&void 0!==i&&t?.(i,a)?i:(n=!0,i=a,a)}}i.d(t,{f:()=>n})},82185:(e,t,i)=>{i.d(t,{R:()=>c});var n=i(6326),r=i(80674),s=i(53084),o=i(68134),a=i(31633),l=i(46053),u=(i(81806),i(76460),i(87990)),p=i(40615),h=i(61607);let c=class extends p.Q{constructor(){super(...arguments),this.type="ground",this.numSamplesForPreview=50,this.numSamplesPerChunk=1e3,this._getStableQueryElevationDependencies=(0,r.f)(()=>({ground:this._ground,groundLayers:this._getStableGroundLayers()}),s.gh),this._getStableGroundLayers=(0,r.f)(()=>this._ground?.layers?.toArray(),s.gh)}get minDemResolution(){return(0,h.W)(this._ground)}get available(){return!0===this._ground?.layers.some(e=>e.visible)}initialize(){this.addHandles([(0,o.wB)(()=>this._queryElevationDependencies,()=>this.onInvalidate(this))])}async queryElevation(e,t){const i=this._queryElevationDependencies;if(null==i)throw new Error(`${this.declaredClass}: no dependencies`);const{ground:n}=i;if(null==n)throw new Error("No ground configured in the view");const r=await n.queryElevation(e,t),s=(0,a.G9)(e.spatialReference),o=(0,a.G9)(n.layers.at(0).spatialReference);if(s!==o){const e=r.geometry;e.points=e.points.map(e=>{let[i,n,r]=e;return[i,n,r===t.noDataValue?r:r*o/s]})}return r}get _queryElevationDependencies(){return this._getStableQueryElevationDependencies()}get _ground(){return this.controller.view?.map?.ground}};(0,n.Cg)([(0,l.MZ)()],c.prototype,"minDemResolution",null),(0,n.Cg)([(0,l.MZ)()],c.prototype,"available",null),(0,n.Cg)([(0,l.MZ)()],c.prototype,"_queryElevationDependencies",null),(0,n.Cg)([(0,l.MZ)()],c.prototype,"_ground",null),c=(0,n.Cg)([(0,u.$)("esri.views.analysis.ElevationProfile.ElevationProfileLineGroundComputation")],c)},94656:(e,t,i)=>{i.d(t,{n:()=>v});var n=i(6326),r=i(91967),s=i(19276),o=i(68134),a=i(46053),l=(i(81806),i(76460),i(47249),i(87990)),u=i(69539),p=i(56611),h=i(45564);let c=class extends r.A{constructor(e){super(e),this.position=null,this.color=new u.A("#ffffff"),this.element=function(){const e=document.createElement("div"),{size:t,borderStyle:i,borderColor:n,borderWidth:r,boxShadow:s}=(0,h.zj)().hoveredPointsStyle,{style:o}=e;return o.display="block",o.position="absolute",o.top="0",o.left="0",o.contain="strict",o.boxSizing="border-box",o.width=`${t}px`,o.height=`${t}px`,o.marginTop=`-${t/2}px`,o.marginLeft=`-${t/2}px`,o.border=`${i} ${r}px ${n}`,o.borderRadius=`${t}px`,o.boxShadow=s,e}()}initialize(){this.addHandles([(0,o.wB)(()=>this._screenLocation,e=>{e&&(this.element.style.transform=`translate(${e.x}px, ${e.y}px)`)},o.pc),(0,o.wB)(()=>this.color.toCss(),e=>{this.element.style.background=e},o.pc)]),this.view.surface?.appendChild(this.element)}destroy(){this.element.remove()}get _screenLocation(){const{position:e,view:t}=this;"3d"===t.type?(t.commitProperty("size"),t.commitProperty("camera")):t.commitProperty("center");const i=t?.spatialReference,n=i?(0,p.projectOrLoad)(e,i).geometry:null;return n&&t?.ready?t.toScreen(n):null}};(0,n.Cg)([(0,a.MZ)()],c.prototype,"position",void 0),(0,n.Cg)([(0,a.MZ)({type:u.A})],c.prototype,"color",void 0),(0,n.Cg)([(0,a.MZ)()],c.prototype,"view",void 0),(0,n.Cg)([(0,a.MZ)()],c.prototype,"_screenLocation",null),c=(0,n.Cg)([(0,l.$)("esri.views.analysis.ElevationProfile.ElevationProfileHoveredPointVisualization")],c);let v=class extends r.A{constructor(e){super(e),this._hoveredPoints=new s.A}initialize(){const{analysisViewData:e}=this,{analysis:t}=e;this.addHandles([(0,o.wB)(()=>{const{hoveredPoints:i,visible:n,updating:r}=e;return n?r?null:i.map((e,i)=>{const n=t.profiles.at(i);return!0===n?.viewOptions.hoveredPointVisible&&null!=e?{hoveredPoint:e,color:n.color}:null}).filter(e=>!!e):[]},e=>this._update(e),o.pc),(0,o.wB)(()=>t.geometry,()=>this._update([]),o.pc)])}destroy(){this._hoveredPoints.drain(e=>e.destroy())}get updating(){return!1}_update(e){if(!e)return;const{view:t,_hoveredPoints:i}=this,n=e.length;for(;i.length>n;)i.pop()?.destroy();for(;i.length<n;){const e=new c({view:t});i.push(e)}for(let r=0;r<n;++r){const t=e[r],s=i.at(n-1-r);s.position=t.hoveredPoint,s.color=t.color}}};(0,n.Cg)([(0,a.MZ)()],v.prototype,"view",void 0),(0,n.Cg)([(0,a.MZ)()],v.prototype,"analysisViewData",void 0),(0,n.Cg)([(0,a.MZ)()],v.prototype,"_hoveredPoints",void 0),(0,n.Cg)([(0,a.MZ)()],v.prototype,"updating",null),v=(0,n.Cg)([(0,l.$)("esri.views.analysis.ElevationProfile.ElevationProfileHoveredPointsVisualization")],v)}}]);
//# sourceMappingURL=75472.e36972e1.chunk.js.map